<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 8 - Gestion des Exceptions - Formation Java Compl√®te</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Highlight.js CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --java-orange: #f89820;
            --java-blue: #5382a1;
            --success-color: #059669;
            --warning-color: #d97706;
            --info-color: #0284c7;
            --dark-color: #1f2937;
            --light-bg: #f8fafc;
            --border-color: #e2e8f0;
            --text-muted: #64748b;
            --question-bg: #f1f5f9;
            --answer-bg: #dcfce7;
            --explanation-bg: #fef3c7;
            --code-bg: #0f172a;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--light-bg);
            color: var(--dark-color);
            line-height: 1.6;
        }

        .navbar {
            background: linear-gradient(135deg, var(--java-orange), var(--java-blue));
            backdrop-filter: blur(10px);
        }

        .sidebar {
            position: sticky;
            top: 100px;
            height: calc(100vh - 120px);
            overflow-y: auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
        }

        .main-content {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .content-header {
            background: linear-gradient(135deg, var(--java-orange), var(--java-blue));
            color: white;
            padding: 2rem;
            text-align: center;
        }

        .section-title {
            color: var(--java-orange);
            font-weight: 700;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .code-block {
            background: var(--code-bg);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
        }

        .exercise-card {
            background: var(--question-bg);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid var(--java-orange);
        }

        .solution-card {
            background: var(--answer-bg);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            border-left: 4px solid var(--success-color);
        }

        .concept-highlight {
            background: linear-gradient(135deg, rgba(248, 152, 32, 0.1), rgba(83, 130, 161, 0.1));
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid var(--java-orange);
        }

        .exception-hierarchy {
            background: #f8fafc;
            border: 2px solid var(--warning-color);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
        }

        .progress-bar {
            background: linear-gradient(135deg, var(--java-orange), var(--java-blue));
            height: 100%;
            width: 66.67%; /* 8/12 modules */
            border-radius: 2px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="../">
                <i class="fas fa-graduation-cap me-2"></i>
                InSkillBoost - Java
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="../">Retour Hub</a>
                <a class="nav-link" href="./">Modules Java</a>
            </div>
        </div>
    </nav>

    <div class="container-fluid" style="margin-top: 80px;">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-lg-3">
                <div class="sidebar">
                    <div style="color: var(--java-orange); font-weight: 600; margin-bottom: 1rem;">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        Module 8 - Gestion des Exceptions
                    </div>
                    
                    <div style="background: var(--border-color); height: 4px; border-radius: 2px; margin: 1rem 0;">
                        <div class="progress-bar"></div>
                    </div>
                    <small class="text-muted d-block mb-3">Module 8 sur 12</small>
                    
                    <a href="#introduction-exceptions" style="display: block; padding: 0.5rem 0; color: var(--java-orange); text-decoration: none;">Introduction Exceptions</a>
                    <a href="#hierarchie-exceptions" style="display: block; padding: 0.5rem 0; color: var(--text-muted); text-decoration: none;">Hi√©rarchie Exceptions</a>
                    <a href="#try-catch-finally" style="display: block; padding: 0.5rem 0; color: var(--text-muted); text-decoration: none;">Try-Catch-Finally</a>
                    <a href="#exceptions-personnalisees" style="display: block; padding: 0.5rem 0; color: var(--text-muted); text-decoration: none;">Exceptions Personnalis√©es</a>
                    <a href="#propagation-exceptions" style="display: block; padding: 0.5rem 0; color: var(--text-muted); text-decoration: none;">Propagation (throws)</a>
                    <a href="#try-with-resources" style="display: block; padding: 0.5rem 0; color: var(--text-muted); text-decoration: none;">Try-with-Resources</a>
                    <a href="#bonnes-pratiques" style="display: block; padding: 0.5rem 0; color: var(--text-muted); text-decoration: none;">Bonnes Pratiques</a>
                    <a href="#exercices" style="display: block; padding: 0.5rem 0; color: var(--text-muted); text-decoration: none;">Exercices (12)</a>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-lg-9">
                <div class="main-content">
                    <div class="content-header">
                        <h1>Module 8 - Gestion des Exceptions</h1>
                        <p class="lead mb-0">Cr√©ez des applications robustes et fiables</p>
                    </div>

                    <div style="padding: 2rem;">
                        <!-- Introduction -->
                        <section id="introduction-exceptions" style="margin-bottom: 3rem;">
                            <h2 class="section-title">
                                <i class="fas fa-shield-alt"></i>
                                Qu'est-ce qu'une Exception ? Votre Bouclier Anti-Crash !
                            </h2>
                            
                            <p>Une <strong>exception</strong> est comme un <strong>signal d'alarme</strong> qui se d√©clenche quand quelque chose d'inattendu arrive dans votre programme. Au lieu de planter brutalement, Java vous donne la chance de r√©agir intelligemment !</p>

                            <div class="concept-highlight">
                                <h5>Analogie : Les Exceptions comme les Panneaux Routiers</h5>
                                <p>Imaginez que vous conduisez et que vous rencontrez des situations impr√©vues :</p>
                                <ul>
                                    <li>üöß <strong>Travaux :</strong> Route ferm√©e ‚Üí Prendre un d√©tour (try-catch)</li>
                                    <li>‚õΩ <strong>Panne d'essence :</strong> S'arr√™ter √† une station (finally)</li>
                                    <li>üö® <strong>Accident :</strong> Appeler les secours (throw exception)</li>
                                    <li>üì± <strong>T√©l√©phone :</strong> Pr√©venir la famille (logging)</li>
                                </ul>
                                <p><strong>Sans gestion :</strong> Accident + voiture d√©truite<br/>
                                <strong>Avec gestion :</strong> Probl√®me r√©solu + voyage continue !</p>
                            </div>

                            <h4>Pourquoi les Exceptions sont VITALES ?</h4>
                            <div class="code-block">
<pre><code class="language-java">/**
 * CAUCHEMAR SANS GESTION D'EXCEPTIONS
 */
public class SansGestionExceptions {
    public static void main(String[] args) {
        System.out.println("Programme d√©marre...");
        
        // Code fragile sans protection
        int[] nombres = {1, 2, 3};
        int resultat = nombres[10]; // BOOM ! ArrayIndexOutOfBoundsException
        
        System.out.println("Cette ligne ne sera JAMAIS ex√©cut√©e");
        System.out.println("Programme termin√©"); // JAMAIS affich√©
    }
}

/*
R√âSULTAT CATASTROPHIQUE :
Programme d√©marre...
Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: Index 10 out of bounds for length 3
	at SansGestionExceptions.main(SansGestionExceptions.java:9)

PROBL√àMES :
‚ùå Programme plante brutalement
‚ùå Message d'erreur technique incompr√©hensible pour l'utilisateur
‚ùå Aucune chance de r√©cup√©ration
‚ùå Donn√©es potentiellement perdues
‚ùå Exp√©rience utilisateur d√©sastreuse
*/

/**
 * G√âNIE AVEC GESTION D'EXCEPTIONS
 */
public class AvecGestionExceptions {
    public static void main(String[] args) {
        System.out.println("Programme d√©marre...");
        
        try {
            // Code potentiellement dangereux prot√©g√©
            int[] nombres = {1, 2, 3};
            System.out.println("Tentative d'acc√®s √† l'index 10...");
            int resultat = nombres[10]; // Exception d√©tect√©e !
            
            System.out.println("R√©sultat: " + resultat); // Jamais ex√©cut√©
            
        } catch (ArrayIndexOutOfBoundsException e) {
            // Gestion intelligente de l'erreur
            System.out.println("üö® Oops ! Index invalide d√©tect√©");
            System.out.println("üí° Conseil: V√©rifiez la taille du tableau");
            System.out.println("üìä Taille disponible: 3 √©l√©ments (index 0-2)");
            
            // On peut m√™me proposer une solution !
            System.out.println("üîß Utilisation de l'index valide le plus proche...");
            int[] nombres = {1, 2, 3};
            int indexSecurise = Math.min(10, nombres.length - 1);
            System.out.println("‚úÖ Valeur √† l'index " + indexSecurise + ": " + nombres[indexSecurise]);
            
        } finally {
            System.out.println("üßπ Nettoyage effectu√© (toujours ex√©cut√©)");
        }
        
        System.out.println("‚úÖ Programme continue normalement !");
        System.out.println("üéØ Mission accomplie - Pas de crash !");
    }
}

/*
R√âSULTAT MAGNIFIQUE :
Programme d√©marre...
Tentative d'acc√®s √† l'index 10...
üö® Oops ! Index invalide d√©tect√©
üí° Conseil: V√©rifiez la taille du tableau
üìä Taille disponible: 3 √©l√©ments (index 0-2)
üîß Utilisation de l'index valide le plus proche...
‚úÖ Valeur √† l'index 2: 3
üßπ Nettoyage effectu√© (toujours ex√©cut√©)
‚úÖ Programme continue normalement !
üéØ Mission accomplie - Pas de crash !

AVANTAGES :
‚úÖ Programme survit √† l'erreur
‚úÖ Message utilisateur compr√©hensible
‚úÖ Solution alternative propos√©e
‚úÖ Nettoyage garanti avec finally
‚úÖ Exp√©rience utilisateur pr√©serv√©e
*/</code></pre>
                            </div>

                            <h4>Les 5 Superpouvoir des Exceptions</h4>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="concept-highlight">
                                        <h6>üõ°Ô∏è 1. Protection Anti-Crash</h6>
                                        <p>Emp√™che l'arr√™t brutal du programme</p>
                                        <div class="code-block">
<pre><code class="language-java">try {
    // Code dangereux
    int result = 10 / 0;
} catch (ArithmeticException e) {
    // Survie garantie !
    System.out.println("Division par z√©ro √©vit√©e");
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="concept-highlight">
                                        <h6>üîç 2. Diagnostic Pr√©cis</h6>
                                        <p>Messages d'erreur d√©taill√©s et utiles</p>
                                        <div class="code-block">
<pre><code class="language-java">catch (FileNotFoundException e) {
    System.out.println("Fichier introuvable: " + e.getMessage());
    System.out.println("V√©rifiez le chemin: " + e.getCause());
    e.printStackTrace(); // Stack trace compl√®te
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="concept-highlight">
                                        <h6>üîÑ 3. R√©cup√©ration Intelligente</h6>
                                        <p>Solutions alternatives automatiques</p>
                                        <div class="code-block">
<pre><code class="language-java">try {
    connecterServeurPrincipal();
} catch (ConnexionException e) {
    // Plan B automatique
    connecterServeurSecours();
    System.out.println("Basculement sur serveur de secours");
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="concept-highlight">
                                        <h6>üßπ 4. Nettoyage Garanti</h6>
                                        <p>Ressources lib√©r√©es m√™me en cas d'erreur</p>
                                        <div class="code-block">
<pre><code class="language-java">FileInputStream file = null;
try {
    file = new FileInputStream("data.txt");
    // Traitement
} finally {
    if (file != null) file.close(); // TOUJOURS ex√©cut√©
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="concept-highlight">
                                        <h6>üìù 5. Tra√ßabilit√© Compl√®te</h6>
                                        <p>Historique d√©taill√© pour le d√©bogage</p>
                                        <div class="code-block">
<pre><code class="language-java">catch (Exception e) {
    // Log complet pour analyse
    logger.error("Erreur dans processData(): " + e.getMessage());
    logger.error("Param√®tres: user=" + userId + ", data=" + data);
    logger.error("Stack trace:", e);
    
    // Notification admin
    envoyerAlerteAdmin("Erreur critique d√©tect√©e", e);
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="concept-highlight">
                                <h5>Pourquoi G√©rer les Exceptions ?</h5>
                                <ul>
                                    <li><strong>Robustesse :</strong> √âviter les plantages inattendus</li>
                                    <li><strong>Maintenance :</strong> Faciliter le d√©bogage</li>
                                    <li><strong>Exp√©rience utilisateur :</strong> Messages d'erreur clairs</li>
                                    <li><strong>R√©cup√©ration :</strong> Permettre au programme de continuer</li>
                                    <li><strong>Logging :</strong> Tracer les erreurs pour l'analyse</li>
                                </ul>
                            </div>

                            <div class="exception-hierarchy">
                                <h6>Hi√©rarchie des Exceptions Java :</h6>
                                <pre>
                            Throwable
                               ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ                     ‚îÇ
                  Error               Exception
                    ‚îÇ                     ‚îÇ
            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚îÇ               ‚îÇ      ‚îÇ                       ‚îÇ
     OutOfMemoryError  StackOver  RuntimeException    IOException
     NoClassDefFound   FlowError      ‚îÇ                    ‚îÇ
                                      ‚îÇ              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ           ‚îÇ
                              ‚îÇ                 ‚îÇ  FileNot   ClassNot
                    NullPointerException  ArrayIndex   Found     Found
                    IllegalArgument       OutOfBounds
                    NumberFormat
                    
    UNCHECKED (Runtime)              CHECKED (Compile-time)
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ            ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    - Erreurs de programmation       - Erreurs pr√©visibles
    - Pas oblig√© de les g√©rer        - Gestion obligatoire
    - RuntimeException et Error      - Exception (sauf Runtime)
                </pre>
                            </div>
                        </section>

                        <!-- Try-Catch-Finally -->
                        <section id="try-catch-finally" style="margin-bottom: 3rem;">
                            <h2 class="section-title">
                                <i class="fas fa-life-ring"></i>
                                Try-Catch-Finally
                            </h2>
                            
                            <h4>Syntaxe Compl√®te</h4>
                            <div class="code-block">
<pre><code class="language-java">import java.util.Scanner;
import java.io.FileReader;
import java.io.IOException;

public class GestionExceptionsComplete {
    public static void main(String[] args) {
        demonstrerTryCatchBasique();
        demonstrerMultiplesCatch();
        demonstrerTryWithFinally();
        demonstrerTryWithResources();
    }
    
    // 1. Try-catch basique
    public static void demonstrerTryCatchBasique() {
        System.out.println("=== TRY-CATCH BASIQUE ===");
        Scanner scanner = new Scanner(System.in);
        
        try {
            System.out.print("Entrez un nombre entier: ");
            String input = scanner.nextLine();
            int nombre = Integer.parseInt(input); // Peut lever NumberFormatException
            
            System.out.print("Entrez un diviseur: ");
            int diviseur = scanner.nextInt();
            int resultat = nombre / diviseur; // Peut lever ArithmeticException
            
            System.out.println("R√©sultat: " + nombre + " / " + diviseur + " = " + resultat);
            
        } catch (NumberFormatException e) {
            System.out.println("‚ùå Erreur: '" + e.getMessage() + "' n'est pas un nombre valide");
            System.out.println("Cause: Mauvais format de nombre");
        } catch (ArithmeticException e) {
            System.out.println("‚ùå Erreur math√©matique: " + e.getMessage());
            System.out.println("Cause: Division par z√©ro interdite");
        }
        
        System.out.println("Programme continue apr√®s l'exception\n");
    }
    
    // 2. Multiples catch avec hi√©rarchie
    public static void demonstrerMultiplesCatch() {
        System.out.println("=== MULTIPLES CATCH ===");
        int[] tableau = {1, 2, 3, 4, 5};
        
        try {
            System.out.println("Acc√®s √† l'index 10 du tableau...");
            int valeur = tableau[10]; // ArrayIndexOutOfBoundsException
            
            String texte = null;
            int longueur = texte.length(); // NullPointerException
            
        } catch (ArrayIndexOutOfBoundsException e) {
            System.out.println("‚ùå Index hors limites: " + e.getMessage());
            System.out.println("Tableau de taille " + tableau.length + ", index max: " + (tableau.length - 1));
            
        } catch (NullPointerException e) {
            System.out.println("‚ùå R√©f√©rence null: " + e.getMessage());
            System.out.println("Tentative d'utilisation d'un objet null");
            
        } catch (RuntimeException e) {
            // Catch g√©n√©rique pour toutes les RuntimeException non g√©r√©es
            System.out.println("‚ùå Erreur runtime non sp√©cifi√©e: " + e.getClass().getSimpleName());
            System.out.println("Message: " + e.getMessage());
            
        } catch (Exception e) {
            // Catch le plus g√©n√©rique (toutes les exceptions)
            System.out.println("‚ùå Erreur g√©n√©rale: " + e.getClass().getSimpleName());
            e.printStackTrace(); // Affiche la stack trace compl√®te
        }
        
        System.out.println("Fin de la d√©monstration multiples catch\n");
    }
    
    // 3. Try-catch-finally
    public static void demonstrerTryWithFinally() {
        System.out.println("=== TRY-CATCH-FINALLY ===");
        FileReader reader = null;
        
        try {
            System.out.println("Tentative d'ouverture du fichier...");
            reader = new FileReader("fichier_inexistant.txt");
            
            // Code qui ne sera jamais ex√©cut√©
            System.out.println("Lecture du fichier...");
            
        } catch (IOException e) {
            System.out.println("‚ùå Erreur I/O: " + e.getMessage());
            System.out.println("Type d'erreur: " + e.getClass().getSimpleName());
            
        } finally {
            // Bloc TOUJOURS ex√©cut√© (exception ou pas)
            System.out.println("üßπ Bloc finally: Nettoyage des ressources");
            
            if (reader != null) {
                try {
                    reader.close();
                    System.out.println("Fichier ferm√© proprement");
                } catch (IOException e) {
                    System.out.println("Erreur lors de la fermeture: " + e.getMessage());
                }
            }
        }
        
        System.out.println("Programme continue apr√®s finally\n");
    }
    
    // 4. Try-with-resources (Java 7+)
    public static void demonstrerTryWithResources() {
        System.out.println("=== TRY-WITH-RESOURCES ===");
        
        // Fermeture automatique des ressources
        try (Scanner scanner = new Scanner("10 20 30 40 50")) {
            System.out.println("Lecture avec fermeture automatique:");
            
            while (scanner.hasNextInt()) {
                int nombre = scanner.nextInt();
                System.out.print(nombre + " ");
            }
            System.out.println();
            
            // Scanner sera automatiquement ferm√©, m√™me si exception
            
        } catch (Exception e) {
            System.out.println("Erreur lors de la lecture: " + e.getMessage());
        }
        
        System.out.println("Scanner ferm√© automatiquement\n");
    }
}</code></pre>
                            </div>
                        </section>

                        <!-- Exceptions Personnalis√©es -->
                        <section id="exceptions-personnalisees" style="margin-bottom: 3rem;">
                            <h2 class="section-title">
                                <i class="fas fa-wrench"></i>
                                Cr√©ation d'Exceptions Personnalis√©es
                            </h2>
                            
                            <div class="code-block">
<pre><code class="language-java">// Exception personnalis√©e pour un compte bancaire
public class CompteBancaireException extends Exception {
    private String typeErreur;
    private double montantTentative;
    private double soldeActuel;
    
    public CompteBancaireException(String message, String typeErreur, 
                                  double montantTentative, double soldeActuel) {
        super(message);
        this.typeErreur = typeErreur;
        this.montantTentative = montantTentative;
        this.soldeActuel = soldeActuel;
    }
    
    @Override
    public String toString() {
        return String.format("CompteBancaireException: %s\n" +
                           "Type d'erreur: %s\n" +
                           "Montant tent√©: %.2f‚Ç¨\n" +
                           "Solde actuel: %.2f‚Ç¨", 
                           getMessage(), typeErreur, montantTentative, soldeActuel);
    }
    
    public String getTypeErreur() { return typeErreur; }
    public double getMontantTentative() { return montantTentative; }
    public double getSoldeActuel() { return soldeActuel; }
}

// Classe utilisant l'exception personnalis√©e
public class CompteBancaireAvance {
    private String numeroCompte;
    private String titulaire;
    private double solde;
    private double decouvertAutorise;
    private static final double MONTANT_MIN_OPERATION = 0.01;
    private static final double MONTANT_MAX_OPERATION = 10000.0;
    
    public CompteBancaireAvance(String titulaire, double soldeInitial) {
        this.numeroCompte = "FR" + System.currentTimeMillis();
        this.titulaire = titulaire;
        this.solde = soldeInitial;
        this.decouvertAutorise = 500.0;
        
        System.out.println("Compte cr√©√©: " + numeroCompte + " pour " + titulaire);
    }
    
    public void deposer(double montant) throws CompteBancaireException {
        // Validation du montant
        if (montant < MONTANT_MIN_OPERATION) {
            throw new CompteBancaireException(
                "Montant de d√©p√¥t trop faible",
                "MONTANT_INSUFFISANT",
                montant,
                solde
            );
        }
        
        if (montant > MONTANT_MAX_OPERATION) {
            throw new CompteBancaireException(
                "Montant de d√©p√¥t trop √©lev√© (limite: " + MONTANT_MAX_OPERATION + "‚Ç¨)",
                "MONTANT_TROP_ELEVE",
                montant,
                solde
            );
        }
        
        solde += montant;
        System.out.printf("‚úÖ D√©p√¥t de %.2f‚Ç¨ effectu√©. Nouveau solde: %.2f‚Ç¨%n", montant, solde);
    }
    
    public void retirer(double montant) throws CompteBancaireException {
        // Validation du montant
        if (montant < MONTANT_MIN_OPERATION) {
            throw new CompteBancaireException(
                "Montant de retrait trop faible",
                "MONTANT_INSUFFISANT", 
                montant,
                solde
            );
        }
        
        // V√©rification du solde avec d√©couvert
        double soldeAvecDecouvert = solde + decouvertAutorise;
        if (montant > soldeAvecDecouvert) {
            throw new CompteBancaireException(
                "Solde insuffisant m√™me avec d√©couvert autoris√©",
                "SOLDE_INSUFFISANT",
                montant,
                solde
            );
        }
        
        solde -= montant;
        System.out.printf("‚úÖ Retrait de %.2f‚Ç¨ effectu√©. Nouveau solde: %.2f‚Ç¨%n", montant, solde);
        
        // Avertissement si d√©couvert
        if (solde < 0) {
            System.out.printf("‚ö†Ô∏è  Compte √† d√©couvert: %.2f‚Ç¨ (Limite: %.2f‚Ç¨)%n", 
                            Math.abs(solde), decouvertAutorise);
        }
    }
    
    public void virement(CompteBancaireAvance compteDestinataire, double montant) 
            throws CompteBancaireException {
        if (compteDestinataire == null) {
            throw new CompteBancaireException(
                "Compte destinataire invalide",
                "COMPTE_INVALIDE",
                montant,
                solde
            );
        }
        
        if (compteDestinataire == this) {
            throw new CompteBancaireException(
                "Impossible de faire un virement vers le m√™me compte",
                "VIREMENT_MEME_COMPTE",
                montant,
                solde
            );
        }
        
        // Retrait du compte source
        this.retirer(montant);
        
        // D√©p√¥t sur le compte destination
        compteDestinataire.deposer(montant);
        
        System.out.printf("üí∏ Virement de %.2f‚Ç¨ vers %s effectu√©%n", 
                         montant, compteDestinataire.getTitulaire());
    }
    
    public void afficherSolde() {
        System.out.printf("Solde de %s (%s): %.2f‚Ç¨%n", titulaire, numeroCompte, solde);
    }
    
    // Getters
    public String getTitulaire() { return titulaire; }
    public double getSolde() { return solde; }
}</code></pre>
                            </div>
                        </section>

                        <!-- Exercices -->
                        <section id="exercices" style="margin-bottom: 3rem;">
                            <h2 class="section-title">
                                <i class="fas fa-dumbbell"></i>
                                Exercices Pratiques sur les Exceptions (12 exercices)
                            </h2>

                            <!-- Exercice 1 -->
                            <div class="exercise-card">
                                <h4 style="color: var(--java-orange); margin-bottom: 1rem;">
                                    <i class="fas fa-calculator"></i> Exercice 1 : Calculatrice Robuste
                                </h4>
                                <p><strong>Objectif :</strong> Cr√©er une calculatrice qui g√®re toutes les erreurs possibles.</p>
                                <p><strong>Gestion d'erreurs :</strong></p>
                                <ul>
                                    <li>Division par z√©ro</li>
                                    <li>Formats de nombres invalides</li>
                                    <li>Op√©rateurs inconnus</li>
                                    <li>D√©bordements de calcul</li>
                                    <li>Entr√©es utilisateur invalides</li>
                                </ul>
                                
                                <button class="btn btn-success btn-sm" type="button" data-bs-toggle="collapse" data-bs-target="#solution1">
                                    Voir la solution
                                </button>
                                
                                <div class="collapse mt-3" id="solution1">
                                    <div class="solution-card">
                                        <div class="code-block">
<pre><code class="language-java">import java.util.Scanner;

// Exception personnalis√©e pour la calculatrice
class CalculatriceException extends Exception {
    private String typeErreur;
    private String operationTentee;
    
    public CalculatriceException(String message, String typeErreur, String operationTentee) {
        super(message);
        this.typeErreur = typeErreur;
        this.operationTentee = operationTentee;
    }
    
    @Override
    public String toString() {
        return String.format("CalculatriceException: %s\nType: %s\nOp√©ration: %s", 
                           getMessage(), typeErreur, operationTentee);
    }
}

public class CalculatriceRobuste {
    private static final Scanner scanner = new Scanner(System.in);
    
    public static void main(String[] args) {
        System.out.println("=== CALCULATRICE ROBUSTE ===");
        System.out.println("Tapez 'quit' pour quitter");
        
        boolean continuer = true;
        
        while (continuer) {
            try {
                System.out.println("\n--- Nouvelle Op√©ration ---");
                
                // Saisie s√©curis√©e du premier nombre
                double nombre1 = saisirNombre("Premier nombre: ");
                
                // Saisie de l'op√©rateur
                String operateur = saisirOperateur();
                if (operateur.equals("quit")) {
                    continuer = false;
                    continue;
                }
                
                // Saisie s√©curis√©e du deuxi√®me nombre
                double nombre2 = saisirNombre("Deuxi√®me nombre: ");
                
                // Calcul avec gestion d'erreurs
                double resultat = effectuerCalcul(nombre1, operateur, nombre2);
                
                // Affichage du r√©sultat
                System.out.printf("‚úÖ R√©sultat: %.2f %s %.2f = %.2f%n", 
                                nombre1, operateur, nombre2, resultat);
                
                // V√©rification de d√©bordement
                if (Double.isInfinite(resultat)) {
                    System.out.println("‚ö†Ô∏è  Attention: R√©sultat infini (d√©bordement)");
                } else if (Double.isNaN(resultat)) {
                    System.out.println("‚ö†Ô∏è  Attention: R√©sultat ind√©termin√© (NaN)");
                }
                
            } catch (CalculatriceException e) {
                System.out.println("‚ùå " + e.getMessage());
                System.out.println("D√©tails: " + e.toString());
                
            } catch (NumberFormatException e) {
                System.out.println("‚ùå Format de nombre invalide: " + e.getMessage());
                
            } catch (Exception e) {
                System.out.println("‚ùå Erreur inattendue: " + e.getMessage());
                e.printStackTrace();
                
            } finally {
                // Nettoyage si n√©cessaire
                System.out.println("üßπ Nettoyage effectu√©");
            }
        }
        
        System.out.println("üëã Au revoir !");
        scanner.close();
    }
    
    private static double saisirNombre(String invite) throws NumberFormatException {
        System.out.print(invite);
        String input = scanner.nextLine().trim();
        
        if (input.equalsIgnoreCase("quit")) {
            throw new NumberFormatException("Arr√™t demand√© par l'utilisateur");
        }
        
        try {
            return Double.parseDouble(input);
        } catch (NumberFormatException e) {
            throw new NumberFormatException("'" + input + "' n'est pas un nombre valide");
        }
    }
    
    private static String saisirOperateur() {
        System.out.print("Op√©rateur (+, -, *, /, %, ^, sqrt): ");
        return scanner.nextLine().trim();
    }
    
    private static double effectuerCalcul(double a, String op, double b) throws CalculatriceException {
        String operation = a + " " + op + " " + b;
        
        switch (op) {
            case "+":
                double somme = a + b;
                if (Double.isInfinite(somme)) {
                    throw new CalculatriceException("D√©bordement lors de l'addition", 
                                                   "OVERFLOW", operation);
                }
                return somme;
                
            case "-":
                return a - b;
                
            case "*":
                double produit = a * b;
                if (Double.isInfinite(produit)) {
                    throw new CalculatriceException("D√©bordement lors de la multiplication", 
                                                   "OVERFLOW", operation);
                }
                return produit;
                
            case "/":
                if (b == 0) {
                    throw new CalculatriceException("Division par z√©ro interdite", 
                                                   "DIVISION_PAR_ZERO", operation);
                }
                return a / b;
                
            case "%":
                if (b == 0) {
                    throw new CalculatriceException("Modulo par z√©ro interdit", 
                                                   "MODULO_PAR_ZERO", operation);
                }
                return a % b;
                
            case "^":
                if (a == 0 && b < 0) {
                    throw new CalculatriceException("0 puissance n√©gative ind√©finie", 
                                                   "PUISSANCE_INDEFINIE", operation);
                }
                return Math.pow(a, b);
                
            case "sqrt":
                if (a < 0) {
                    throw new CalculatriceException("Racine carr√©e d'un nombre n√©gatif", 
                                                   "RACINE_NEGATIVE", a + " sqrt");
                }
                return Math.sqrt(a);
                
            default:
                throw new CalculatriceException("Op√©rateur inconnu: " + op, 
                                               "OPERATEUR_INCONNU", operation);
        }
    }
}</code></pre>
                            </div>
                        </section>

                        <!-- Navigation -->
                        <div style="display: flex; justify-content: space-between; margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border-color);">
                            <a href="module-7-interfaces-abstractions.html" style="background: linear-gradient(135deg, var(--java-orange), var(--java-blue)); color: white; padding: 0.75rem 1.5rem; border-radius: 8px; text-decoration: none;">
                                <i class="fas fa-arrow-left me-2"></i>Module 7 : Interfaces
                            </a>
                            <a href="module-9-collections-generiques.html" style="background: linear-gradient(135deg, var(--java-orange), var(--java-blue)); color: white; padding: 0.75rem 1.5rem; border-radius: 8px; text-decoration: none;">
                                Module 9 : Collections
                                <i class="fas fa-arrow-right ms-2"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/java.min.js"></script>
    
    <script>
        hljs.highlightAll();
        
        document.querySelectorAll('a[href^="#"]').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
    </script>
</body>
</html>
